    function updateUI() {
        const parseDate = (s) => { const p = s.split('.'); return new Date(p[2], p[1]-1, p[0]); };
        appData.eintraege.sort((a,b) => parseDate(a.datum) - parseDate(b.datum));

        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        let m = 0, k = 0;

        appData.eintraege.forEach(e => {
            const isL = e.typ === 'lieferung';
            if(isL) { m += e.menge_m3; k += e.preis_total_eur; }
            tbody.innerHTML += `<tr>
                <td>${e.datum}</td>
                <td><span class="tag" style="background:${isL?'#e8f5e9':'#e1f5fe'}">${isL?'Lief':'Zähl'}</span></td>
                <td>${fmt(isL?e.menge_m3:e.zaehlerstand_m3)} m³</td>
                <td>${isL?fmt(e.preis_total_eur)+' €':'-'}</td>
                <td>${e.notiz}</td>
            </tr>`;
        });

        document.getElementById('sM').innerText = fmt(m) + " m³";
        document.getElementById('sK').innerText = fmt(k) + " €";
        document.getElementById('sP').innerText = fmt(m>0?k/m:0) + " €/m³";
        renderChart();
    }

	function renderChart() {
	    const ctx = document.getElementById('gasChart').getContext('2d');
	    if(chart) chart.destroy();

	    // Wir filtern nach Typ, damit wir zwei saubere Linien bekommen
	    const zaehlerDaten = appData.eintraege
	        .filter(e => e.typ === 'zaehler')
	        .map(e => ({ x: e.datum, y: e.zaehlerstand_m3 }));

	    const lieferDaten = appData.eintraege
	        .filter(e => e.typ === 'lieferung')
	        .map(e => ({ x: e.datum, y: e.menge_m3 }));

	    chart = new Chart(ctx, {
	        type: 'line',
	        data: {
	            datasets: [
	                {
	                    label: 'Zählerstand (m³)',
	                    data: zaehlerDaten,
	                    borderColor: '#007aff',
	                    backgroundColor: '#007aff',
	                    borderWidth: 3,
	                    pointRadius: 5, // Macht den Punkt sichtbar
	                    pointHoverRadius: 8,
	                    spanGaps: true,
	                    showLine: true // Erzwingt die Linie
	                },
	                {
	                    label: 'Liefermenge (m³)',
	                    data: lieferDaten,
	                    borderColor: '#34c759',
	                    backgroundColor: '#34c75944',
	                    type: 'bar', // Lieferungen als Balken sehen oft besser aus
	                    barPercentage: 0.5
	                }
	            ]
	        },
	        options: {
	            responsive: true,
	            maintainAspectRatio: false,
	            scales: {
	                x: {
	                    type: 'category',
	                    title: { display: true, text: 'Datum' }
	                },
	                y: {
	                    beginAtZero: false,
	                    title: { display: true, text: 'm³' }
	                }
	            },
	            plugins: {
	                legend: { display: true, position: 'top' }
	            }
	        }
	    });
	}
